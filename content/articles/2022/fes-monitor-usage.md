---
slug: /articles/fes-monitor-usage
date: 2022-04-25
last_update: 2022-04-25
title: KSS Fes Monitor の 使い方
description: 文化祭の待ち時間モニターの使い方を説明します。
---

## KSS Fes Monitor って何？

<img src="/images/articles/2022/fes-monitor-usage/using-monitor.png" width="400">

これです。特別棟 1 階の階段前と、本棟 2 階の職員室の前に置いてあったやつ。
画像は 2019 年度のものですが、用途的には同じです。

<img src="/images/articles/2022/fes-monitor-usage/monitor-image1.png" width="600">
<img src="/images/articles/2022/fes-monitor-usage/monitor-image2.png" width="600">

（画面は開発段階のものであり、変更される場合があります）

こんな感じで、各クラスの模擬店の待ち時間や商品の在庫状況をお客さんに知らせることができます。

## 使い方

### 文化祭開始前

#### 1. Firebase プロジェクトのアクセス権を得る

Discord の OB/OG の欄に「Asa」がいます。
その人に、**自分の Google アカウントのメールアドレスと一緒に**「KSS Fes Monitor の Firebase のアクセス権ください」などと言ってください。アクセス権あげます。<br>
もしくは、すでにアクセス権を持ってる人に言ってもいいです。

もちろん、権限を乱用しないでください。Asa 宛に請求が来ます。やめてください。<br>
（乱用できないような設定もできるけど、各自でメンバー追加をできなくなってしまう恐れがあるため、その設定はしてません。）

#### 2. 各模擬店アカウントの作成

Firebase にアクセスできるようになったら、アカウントを作成します。

1. <p>https://console.firebase.google.com/project/kss-festival-admin/authentication/users にアクセスしてください。</p>
2. <p>「ユーザーを追加」をクリックします。</p>
   <p><img src="/images/articles/2022/fes-monitor-usage/firebase-auth1.png" width="600"></p>
3. <p>メールアドレスとパスワードを入力します。
   が、さすがに各クラスの人のメールアドレスを登録させるわけにもいかないので、「fes-g(学年)c(組)@kss-pc.club」としてください。
   部活動の場合、「fes-club-(その部活動を表す文字列)@kss-pc.club」とするとよいでしょう。
   パスワードは、ランダムな英数字8文字くらいがよいかもしれません。記号は使えないかもしれません（たぶん）。</p>
   <p>なお、メールを受け取れないので、<b>パスワードの再設定ができません、必ずメールアドレスとパスワードの組を控えておいてください</b>。
   もし紛失したら、Google Domainsに行ってメールの転送設定を追加するなり、アカウントを削除・再追加するなりしてください。</p>
   <p>例1: 3年2組の場合「fes-g3c2@kss-pc.club」<br>
   例2: 科学部の場合「fes-club-science@kss-pc.club」（適当に考えてください）</p>
   <p><img src="/images/articles/2022/fes-monitor-usage/firebase-auth2.png" width="600"></p>

一応、これでアカウント自体の作成は完了しました。

次に、模擬店のデータベースを作成します。

1. <p>先ほどのアカウント生成の画面で、「ユーザーUID」をコピーしてください。</p>
2. <p>左の「Firestore Database」に移動します。</p>
3. <p>「コレクションを開始」と書かれている下にいくつかのデータがあります。まずは「chat」をクリックします。</p>
4. <p>真ん中の部分に「ドキュメントを追加」とあるので、クリックします。</p>
5. <p>以下のデータに変更し、「保存」します。</p>
   <p><img src="/images/articles/2022/fes-monitor-usage/firebase-db1.png" width="600"></p>
6. <p>次に、「コレクションを開始」の下「class_info」をクリックし、同様に「ドキュメントを追加」をクリックします。</p>
   <p>内容はこの通りです。<br><img src="/images/articles/2022/fes-monitor-usage/firebase-db2.png" width="600"></p>
   <p>ちなみに、ここで https://monitor.festival.kss-pc.club/ を開いてみると、新しくデータが追加されていることが確認できます。 </p>
7. <p>次に、「class_proceeds」をクリックし、同様に「ドキュメントを追加」をクリックします。</p>
   <p>内容はこの通りです。<br><img src="/images/articles/2022/fes-monitor-usage/firebase-db3.png" width="600"></p>

管理者権限を持ったあなたのアカウントも作りましょう。<br>
管理者権限のアカウントには、各模擬店からの質問などがチャットで飛んできます。
対応してあげてね。<br>
なお、管理者権限のアカウントごとじゃなくて、「管理者」という 1 アカウントにチャットが飛んでくる感じです。誰か 1 人が対応したら、ほかの人は対応しなくて良いです。そこは連携してね。

基本的には、上の手順です。以下の点を除いて。

- メールアドレスは自分のアドレスに、パスワードも自分の覚えやすいものにしてください。
- データベース作成の際、「class_info」の作成は飛ばしてください。モニターに表示されてしまいます。
- 「class_proceeds」の内容で、「admin」を「true」にしてください。

以上で終わりです。お疲れさまでした。

#### 3. 文化祭情報の設定

さて、KSS Fes Monitor の右下をご覧ください。
現在時刻のとなり。カウントダウンタイマーがあります。

このタイマーですが、文化祭開催前は「文化祭はまもなく開始します。開始まで...」、文化祭中は「文化祭終了まで...」、終了後は「文化祭は終了しました。本日はご来場ありがとうございました！」と表示されます。

年度ごとに異なるタイマーの設定は、Firebase 上で行うことができます。

1. 「Firestore Database」に移動します
2. 「コレクションを開始」の下「festival_duration」をクリックします
3. 「ドキュメントを追加」の下「time」をクリックします
4. 「フィールドを追加」の下に「end」「start」があるので、それを変更してください。その名の通り、「start」は開始時刻、「end」は終了時刻です。

#### 4. 模擬店アカウントの通達

各クラスに、先ほど作ったアカウント情報を、紙なり LINE なりで通達します。

具体的には、以下の情報を伝えてあげてください。

- ログイン URL https://admin.festival.kss-pc.club/ （この URL は、管理者アカウントでも同じです）
- メールアドレス
- パスワード

また、これらの情報も必要に応じて、わかりやすく書いてあげましょう。

- アカウントについて
  - この情報をなくさないようにする（パソコン部側で保有していればいいけど、一応写真を撮っておくなど）
  - ただし、メールアドレス・パスワードは流出させない！
- モニター更新について
  - ログイン後、「モニター情報変更」から変更できる
  - 「モニター情報変更」の画面は、「更新」を押さなければ更新されない（モニターに反映されない）
  - メニューは 5 個まで（ドリンクは「ドリンク」としてまとめるなど）
  - メニューアイコンは、重複しないようにする（モニター側からすると同じものが複数あるように見える）
- その他
  - 書いてあるメールアドレスに何か送っても誰にも届かない
  - 何かあればログイン後の「チャットシステム」から連絡できる
  - 「レジシステム」や「売上確認」機能は使っても使わなくてもいい（KSS Pay を使う前提に作った機能なので。ただ、ちゃんと機能はする）

#### 5. メニューアイコンの追加

<img src="/images/articles/2022/fes-monitor-usage/icon-add1.png">

「メニューアイコン」は、上の画像のように表示されるものです。
何が販売中/営業中なのか、もしくは売り切れ/営業終了なのか、などが一目でわかるアイコンが必要です。<br>
私は「いらすとや」のアイコンを使いましたが、一目でわかればなんでもいいです。

初期段階では、「カレーライス」「エビフライ」「フライドポテト」「豚骨ラーメン」「うな重」のアイコンしかないです。
これでは明らかにクラスの需要に合っていないので、需要に応じて追加してあげてください。

1. [kss-pc-club/Fes-Monitor](https://github.com/kss-pc-club/Fes-Monitor) をローカルに Clone してください。
2. アイコンを `/public/icons` にコピーしてください。ファイル名はそれを表すような名前、拡張子は .png で。
3. 変更を Commit して、GitHub に Push してください。
4. [kss-pc-club/KSS-Fes-Admin](https://github.com/kss-pc-club/KSS-Fes-Admin) をローカルに Clone してください。
5. `/src/monitor/availableIcons.ts` を開きます。
6. `availableIconsList` に、「`[ファイル名(拡張子なし)] : '[アイコンが表すメニュー]'`」を追加してください。ほかの例を見るとわかるかと思います。
7. 変更を Commit して、GitHub に Push してください。

これで、アイコンが使えるようになります。

注意点として、似ているものや、カテゴリが同じものは 1 つにまとめてしまってください。クラス側と PC 部側両方の管理が大変であること、モニター利用者からすると同じものが複数あるように見えること、などが理由としてあります。<br>
例えば、「オレンジジュース」「コーラ」などは「ドリンク」として、「ポップコーン キャラメル味」「ポップコーン 塩味」は「ポップコーン」として、...など。

#### 6. モニターの設置

これが一番重要です。時系列ごとに分けて説明します。

##### 文化祭前日までにやること

- 借用書を書く<br>
  これがないとモニターが設置できません。
  借りるものは、「モニター 2 台」くらい？
  必要に応じて延長コードなど。
- 設置場所について担当の先生と相談する<br>
  無断設置はよくありません。
  近くにコンセントがあるといいかも。
- 用いる PC を準備する<br>
  モニターに使う PC は、ディスプレイ常時稼働させるように設定を変更します。モニター 1 台に対して、PC1 台。<br>
  解像度は 1920x1080 がいいです。それより小さいとレイアウト崩れそう。大きいのは試していないのでわかりません...特に問題なさそうであればなんでもいいです。<br>
  電子黒板に Android OS 入ってる？みたいな話を聞いたので、それでブラウザが使えれば必要ないです。
- HDMI ケーブルが使えるかチェック<br>
  確か、PC 部で HDMI ケーブルを持っていた気がします。それでちゃんと映るかチェックしておいてください。映らなければ購入するか、借りるかなどしてください。<br>
  これも、電子黒板でブラウザが使えれば必要ないです。
- ちゃんと動作するかチェックする<br>
  https://monitor.festival.kss-pc.club/ にアクセスしてみて、ちゃんと動作するか確認してください。動かなければ修正が必要になりそうなので。<br>
  もしテスト用データを作ったのであればそれをデータベースから削除してください。<br>
  全画面表示もできるかどうかもチェックしてください。

##### 文化祭前日にやること

- モニターを設置する<br>
  所定の位置に設置してください。また、電源などいろいろ接続してください。<br>
- 紙を貼る<br>
  ページ最初の見本画像にあったように、モニターに触らないように促す紙を作り、貼ります。「さわらないで」などと書いてあればいい気がします。

##### 文化祭当日、開始前にやること

- モニターをつける<br>
  前日からつけっぱなしにしないでください。先生に怒られる気がします。
- 全画面表示にする<br>
  お客さんがもし触ったときに反応する領域を最小限にする（タスクバーとか触られたら厄介）ことや、レイアウトが崩れないようにすることなどが理由としてあります。

### 文化祭中

#### チャットに対応する

先ほども述べたように、クラス側からチャットが飛んでくる可能性があります。
対応してあげてください。

管理者アカウントが複数ある場合、クラス側は「管理者 ○○ と個別に話す」ではなく、「管理者と話す」感じです。つまり、管理者アカウント全員に対してチャットが届きます。<br>
そのため、複数のアカウントから同時に返信すると、クラス側からすると「複数返信が来た...？？どれが正しいの？」となります。誰が返信するかなどをうまく連携をとって、対応してください。

チャット対応用の管理者用 PC1 台あってもいいかもです。

なお、チャットについては、ログイン URL（ https://admin.festival.kss-pc.club ）で、管理者アカウントとしてログインすると使えます。
使い方は察しろください()

#### イベント開催情報をアップデートする

部活動などの催しがあると思います。そのお知らせがモニター下部にスクロール表示されます。<br>
しかしこの情報は手動更新です...Firebase から直接変えます。
もし必要であれば、その情報変更ページを作るので言ってください。~~なら最初から作っておけ~~

1. アクセス権のある Google アカウントにログインした状態で、 https://console.firebase.google.com/project/kss-festival-admin/firestore/data/~2Fmonitor~2Fscroll_info にアクセスします。
2. コレクション「monitor」、ドキュメント「scroll_info」になっていることを確認して、フィールド「text」を変更します。

例えば

- 文化祭開始直後は「文化祭がスタートしました！ぜひお楽しみください！」
- 催しがある場合は「(時刻)より、(場所)にて ○○ 部による ×× が開催されます。」
- 特になければ「ご来場ありがとうございます！ぜひお楽しみください！！」

などと書いておいてください～
もちろん適宜変更してください

#### 定期的にモニターが動いているかチェックする

ちゃんと動いていなければお客さんが困ります。
定期的に動いているか、ちゃんと掲示が 1 周するまでチェックしてください。
動いていなければ、再読み込みするなりデータベース変更するなり、修正してください。

チェックの間隔は、30 分くらいでいいと思います。
まあ暇なときに見る程度の感覚でいいです。

### 文化祭終了後

#### 模擬店アカウントの削除
